#!/usr/bin/env python

import i3ipc
import subprocess
workspaces = ""
i3 = ""
def main():
    global i3
    i3 = i3ipc.Connection(auto_reconnect=True)
    i3.on('window::move', on_change)
    i3.on('window::close', on_change)
    i3.on('window::new', on_change)
    # Could use ticks but not implemented in latest release of i3ipc-python
    try:
        i3.main()
    finally:
        i3.main_quit()


def on_change(_, e):
    global i3
    global workspaces
    workspaces = i3.get_workspaces()
    i = 1
    for workspace in workspaces:
        i3.command(f'rename workspace {workspace.name} to {i}')
        i+=1

if __name__ == '__main__':
    main()
